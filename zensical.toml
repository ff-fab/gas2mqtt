# Documentation site configuration (native Zensical format)
#
# Zensical is a documentation framework by the creators of Material for MkDocs.
# This file replaces mkdocs.yml with native TOML configuration.
#
# Usage (via Taskfile — single source of truth for tool commands):
#   task docs:serve       # Local preview with hot reload
#   task docs:build       # Build static site to site/
#

# Structure follows a user-journey (lifecycle) model:
#   Get Started     — onboarding-oriented (first success quickly)
#   Install/Setup   — environment-oriented (prereqs, installation, config)
#   Use             — outcome-oriented (common end-to-end flows)
#   (Optional) Operate — operations-oriented (deploy, monitor, upgrade, security)
#   (Optional) Troubleshoot — recovery-oriented (diagnosis, known issues, fixes)
#   Reference       — lookup-oriented (API/CLI/config, schemas)


# ---------------------------------------------------------------------------
# Project
# ---------------------------------------------------------------------------

[project]
site_name = "gas2mqtt"
site_description = "An app to read a domestic gas meter using a digital magnetometer."

# Canonical URL for the deployed site. Used for sitemap and social cards.
# Note: zensical.toml does not support environment variable substitution.
# The CI workflow hardcodes the same URL, so this is the single source of truth.
site_url = "https://ff-fab.github.io/gas2mqtt/"

repo_url = "https://github.com/ff-fab/gas2mqtt"
repo_name = "ff-fab/gas2mqtt"
edit_uri = "edit/main/docs/"

# ---------------------------------------------------------------------------
# Navigation
# ---------------------------------------------------------------------------

nav = [
    { "Home" = "index.md" },
    { "Getting Started" = "getting-started.md" },
    { "Configuration" = "configuration.md" },
    { "MQTT Topics" = "mqtt-topics.md" },
    { "Architecture" = "architecture.md" },
    { "Reference" = [
        { "Overview" = "reference/index.md" },
        { "Settings" = "reference/settings.md" },
        { "Ports" = "reference/ports.md" },
        { "Domain" = "reference/domain.md" },
        { "Devices" = "reference/devices.md" },
        { "Adapters" = "reference/adapters.md" },
        { "Application" = "reference/app.md" },
    ] },
    { "ADRs" = "adr/" },
]

# Note: exclude_docs is not yet supported in zensical.toml (see Zensical docs).
# The TODO/, demos/, and testing/ directories may appear as unlisted pages.

# ---------------------------------------------------------------------------
# Theme
# ---------------------------------------------------------------------------

[project.theme]
# Zensical's modern design (the default). Use variant = "classic" to restore
# the Material for MkDocs appearance.
features = [
    "navigation.tabs",
    "navigation.tabs.sticky",
    "navigation.sections",
    "navigation.expand",
    "navigation.indexes",
    "navigation.top",
    "search.suggest",
    "search.highlight",
    "content.code.copy",
    "content.code.annotate",
    "content.tabs.link",
    "content.action.edit",
]

[project.theme.icon]
repo = "fontawesome/brands/github"

# --- Color palette toggle (dark / light) ---

[[project.theme.palette]]
scheme = "slate"
primary = "teal"
accent = "cyan"
toggle.icon = "material/brightness-4"
toggle.name = "Switch to light mode"

[[project.theme.palette]]
scheme = "default"
primary = "teal"
accent = "cyan"
toggle.icon = "material/brightness-7"
toggle.name = "Switch to dark mode"

# ---------------------------------------------------------------------------
# Plugins
# ---------------------------------------------------------------------------

[project.plugins.autorefs]

[project.plugins.mkdocstrings.handlers.python]
paths = ["packages/src"]

[project.plugins.mkdocstrings.handlers.python.options]
show_source = true
show_root_heading = true
show_symbol_type_heading = true
members_order = "source"
show_signature_annotations = true
separate_signature = true
signature_crossrefs = true
merge_init_into_class = true
docstring_style = "google"

# ---------------------------------------------------------------------------
# Markdown extensions
# ---------------------------------------------------------------------------

# Admonitions (note, warning, tip, etc.)
[project.markdown_extensions.admonition]
[project.markdown_extensions.pymdownx.details]

# HTML / attribute extensions (required for grid cards, icon sizing)
[project.markdown_extensions.attr_list]
[project.markdown_extensions.md_in_html]

# Code blocks
[project.markdown_extensions.pymdownx.highlight]
anchor_linenums = true
line_spans = "__span"
pygments_lang_class = true

[project.markdown_extensions.pymdownx.inlinehilite]

[project.markdown_extensions.pymdownx.superfences]

[[project.markdown_extensions.pymdownx.superfences.custom_fences]]
name = "mermaid"
class = "mermaid"
format = "pymdownx.superfences.fence_code_format"

# Content tabs (e.g., showing Python / TypeScript side by side)
[project.markdown_extensions.pymdownx.tabbed]
alternate_style = true

# Typography and formatting
[project.markdown_extensions.pymdownx.mark]
[project.markdown_extensions.pymdownx.smartsymbols]
[project.markdown_extensions.pymdownx.keys]

# Lists and task lists
[project.markdown_extensions.def_list]
[project.markdown_extensions.pymdownx.tasklist]
custom_checkbox = true

# Table of contents
[project.markdown_extensions.toc]
permalink = true
toc_depth = 3

# Tables
[project.markdown_extensions.tables]

# Footnotes
[project.markdown_extensions.footnotes]

# Emoji (used sparingly for status indicators)
[project.markdown_extensions.pymdownx.emoji]
emoji_index = "zensical.extensions.emoji.twemoji"
emoji_generator = "zensical.extensions.emoji.to_svg"

# ---------------------------------------------------------------------------
# Extra
# ---------------------------------------------------------------------------

[[project.extra.social]]
icon = "fontawesome/brands/github"
link = "https://github.com/ff-fab/gas2mqtt"
